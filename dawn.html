<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>dawn</title>
    <link href="./public/dawn_stylesheet.css" type="text/css" rel="stylesheet">
  </head>
  <body>

    <script src="./node_modules/matter-js/build/matter.js"></script>
    <script src="./models/Cell.js"></script>
    <script src="./models/Simulation.js"></script>
    <script src="./models/DecoratedEngine.js"></script>
    <script src="./models/CellRepository.js"></script>
    <script src="./models/Gait.js"></script>
    <script src="./models/Animator.js"></script>
    <script src="./models/EventController.js"></script>

    <script>
      // instantiate our objects
      var decoratedEngine = new DecoratedEngine();
      decoratedEngine.disableGravity(); // should go in setup
      var renderer = Matter.Render.create({element: document.body, engine: decoratedEngine.matterEngine()});
      var eventController = new EventController();
      var animator = new Animator();
      var simulation = new Simulation(decoratedEngine.matterEngine(), renderer);
      simulation.setup()
      var cellRepository = new CellRepository();
      // need a cell factory to remove the next 4 lines
      var gait = new Gait()
      var firstCell = new Cell(Matter.Bodies.circle(50, 200, 10, 10), gait);
      var secondCell = new Cell(Matter.Bodies.circle(150, 200, 10, 20), gait);
      var thirdCell = new Cell(Matter.Bodies.circle(300, 200, 10, 40), gait);

      // add things to things (really need a cell factory)
      simulation.addToWorld(firstCell);
      simulation.addToWorld(secondCell);
      simulation.addToWorld(thirdCell);
      cellRepository.add(firstCell);
      cellRepository.add(secondCell);
      cellRepository.add(thirdCell);

      // register our listener
      eventController.register(decoratedEngine.matterEngine(), 'afterUpdate', animator, cellRepository)

      // run things
      Matter.Engine.run(decoratedEngine.matterEngine());
      Matter.Render.run(renderer);
    </script>

    <!-- <script>
      var myEngine = new DecoratedEngine();
      myEngine.disableGravity();
      var myRenderer = Matter.Render.create({element: document.body, engine: myEngine.matterEngine()});
      var ourWorld = Matter.World;
      var MvpSimulation = new Simulation(myEngine.matterEngine(), myRenderer, ourWorld, Matter.Events, Matter.Body);
      MvpSimulation.setup()
      var firstCell = new Cell(Matter.Bodies.circle(50, 200, 10, 10));
      var secondCell = new Cell(Matter.Bodies.circle(150, 200, 10, 20));
      var thirdCell = new Cell(Matter.Bodies.circle(300, 200, 10, 40));
      MvpSimulation.addToWorld(firstCell);
      MvpSimulation.addToWorld(secondCell);
      MvpSimulation.addToWorld(thirdCell);
      MvpSimulation.listenForUpdate();
      Matter.Engine.run(myEngine.matterEngine());
      Matter.Render.run(myRenderer);
    </script> -->

  </body>
</html>
